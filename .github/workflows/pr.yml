name: pr

on:
  pull_request:

permissions:
  pull-requests: write

jobs:
  unit-test-pr:
    uses: ./.github/workflows/_unit-test.yml
  e2e-test-unsocial-pr:
    uses: ./.github/workflows/_e2e-test.yml
    secrets: inherit
    with:
      target: unsocial
  e2e-test-mastodon-pr:
    uses: ./.github/workflows/_e2e-test.yml
    secrets: inherit
    with:
      target: mastodon
  e2e-test-misskey-pr:
    uses: ./.github/workflows/_e2e-test.yml
    secrets: inherit
    with:
      target: misskey
  mutation-test-pr:
    uses: ./.github/workflows/_mutation-test.yml
    secrets: inherit
  nodejs-test-pr:
    runs-on: ubuntu-latest
    if: startsWith(github.head_ref, 'renovate/node-')
    steps:
      - uses: actions/checkout@v4
      - uses: jdx/rtx-action@v1
